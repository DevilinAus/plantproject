<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Plant Health Dashboard</title>
    <style>
    /* RESET FOR OLD SAFARI */
    body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; font-family: -apple-system, Helvetica; }
    /* LANDSCAPE LAYOUT (fixed for iPad Mini 1) */
    body { width: 1024px; height: 768px; background: #f0f4f0; color: #333; position: relative; }
    /* HEADER */
    .header { position: absolute; top: 0; left: 0; right: 0; height: 60px; background: #2c5e3a; color: white; }
    .header h1 { margin: 12px 0 0 20px; font-size: 24px; padding-top: 10px }
    /* SIDEBAR */
    .sidebar { position: absolute; top: 60px; bottom: 0; left: 0; width: 200px; background: #fff; border-right: 1px solid #ddd; }
    .sidebar-nav { list-style: none; padding: 20px 0; }
    .sidebar-nav li { padding: 10px 20px; border-bottom: 1px solid #eee; }
    .sidebar-nav li.active { background: #e8f4ea; font-weight: bold; }
    /* MAIN CONTENT */
    .main { position: absolute; top: 60px; left: 200px; right: 0; bottom: 0; padding: 20px; overflow-y: auto; }
    /* CARDS */
    .card { background: white; border-radius: 4px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px; padding: 15px; }
    .card-title { font-size: 18px; margin: 0 0 10px 0; color: #2c5e3a; }
    /* PLANT STATUS GRID (using floats for compatibility) */
    .plant-grid { overflow: hidden; }
    .plant-item { float: left; width: 30%; margin: 0 1.5% 20px 1.5%; text-align: center; }
    .plant-icon { width: 50px; height: 50px; background: #8bc34a; border-radius: 50%; margin: 0 auto 10px; line-height: 50px; color: white; }
    .plant-name { font-weight: bold; }
    .plant-status { font-size: 12px; color: #666; }
    .plant-status.alert { color: #e74c3c; }
    /* GAUGE (simple CSS-only) */
    .gauge { height: 10px; background: #eee; border-radius: 5px; margin: 10px 0; }
    .gauge-fill { height: 10px; border-radius: 5px; background: #2c5e3a; width: 70%; }
    /* RESPONSIVE TEXT SIZES */
    @media (max-width: 1024px) { body { font-size: 14px; } }
    </style>
  </head>
  <body>
    <!-- HEADER -->
    <div class="header">
      <h1>Plant Health Dashboard</h1>
    </div>
    <!-- SIDEBAR -->
    <div class="sidebar">
      <ul class="sidebar-nav">
        <li class="active">Overview</li>
        <li>Alerts</li>
        <li>Species</li>
        <li>Settings</li>
      </ul>
    </div>
    <!-- MAIN CONTENT -->
    <div class="main">
      <!-- STATUS SUMMARY -->
      <div class="card">
        <h2 class="card-title">Plant Status</h2>
        <div class="plant-grid">
          <!-- <div class="plant-item">
          <div class="plant-icon">üå±</div>
          <div class="plant-name">Basil</div>
          <div class="plant-status">Healthy</div>
        </div> -->
          <div class="plant-item">
            <div class="plant-icon">üçÖ</div>
            <div class="plant-name">Tomato</div>
            <div class="status" id="status">placeholder</div>
          </div>
          <!-- <div class="plant-item">
          <div class="plant-icon">üçÉ</div>
          <div class="plant-name">Fern</div>
          <div class="plant-status">Stable</div>
        </div> -->
        </div>
      </div>
      <!-- DATA METRICS -->
      <div class="card">
        <h2 class="card-title">Environment</h2>
        <p>Humidity: 65%</p>
        <div class="gauge">
          <div class="gauge-fill" style="width: 65%;"></div>
        </div>
        <p>Temperature: 22¬∞C</p>
        <div class="gauge">
          <div class="gauge-fill" style="width: 50%;"></div>
        </div>
        <p>Light Exposure: Moderate</p>
        <div class="gauge">
          <div class="gauge-fill" style="width: 40%;"></div>
        </div>
      </div>
    </div>
    <!-- MOCK DATA FETCHING (simulated with old JS) -->
    <script type="text/javascript">
    // Simulate loading data (iOS 9.3.5 doesn't support fetch(), use XHR)
    


    function updateDashboard() {
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "/api/dashboard", true);
            xhr.onload = function () {
                if (xhr.status === 200) {
                    var data = JSON.parse(xhr.responseText);
                    document.getElementById("status").textContent = data.status;
                    document.getElementById("moisture").textContent = data.moisture;
                } else {
                    document.getElementById("status").textContent = "Error fetching data";
                }
            };
            xhr.onerror = function () {
                document.getElementById("status").textContent = "Request failed";
            };
            xhr.send();
        }

        updateDashboard();               // Initial load
        setInterval(updateDashboard, 5000);  // Repeat every 5 seconds
    </script>
  </body>
</html>
